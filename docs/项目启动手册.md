# 中道商城系统 - 项目启动手册

**文档目的**：为新加入的AI协作者和人类开发者提供完整的项目启动指南
**适用范围**：所有新加入项目开发的团队成员
**最后更新**：2025年11月18日
**版本**：1.0

---

## 🎯 欢迎加入中道商城项目！

### 项目概览

中道商城是一个创新的**多层级供应链社交电商平台**，通过以下核心特色重新定义传统分销：

- 🏪 **双店铺体系**：云店（累积升级）+ 五通店（特殊权益）
- 👥 **6级用户体系**：从普通会员到董事的完整成长路径
- 💰 **复杂采购规则**：层级限制 + 中间人业绩 + 平级奖励
- 📦 **双仓库存机制**：云仓（团队共享）+ 本地仓（个人独有）
- 💎 **通券多源流转**：进货 + 转账 + 充值的多维流转体系

### 商业目标

- **12个月目标**：月GMV 2000万+，活跃店长5000+
- **技术目标**：微服务架构，支持10万+并发用户
- **用户体验**：99.9%系统可用性，<2秒响应时间

---

## 🚀 快速启动流程

### Step 1: 环境准备（30分钟）

#### 1.1 系统要求检查
```bash
# 检查Node.js版本（必须≥18.0.0）
node --version

# 检查Docker版本
docker --version
docker-compose --version

# 检查Git版本
git --version
```

#### 1.2 一键启动开发环境
```bash
# 克隆项目（如果还没有）
git clone https://github.com/yourusername/zhongdao-mall.git
cd zhongdao-mall

# 启动完整开发环境
./scripts/quick-start.sh

# 启动AI协同系统
./scripts/start-collaboration.sh
```

#### 1.3 验证环境
```bash
# 检查服务状态
./scripts/env-manager.sh status

# 检查API健康
curl http://localhost:3000/health

# 检查数据库连接
npx prisma studio --browser none &
```

### Step 2: 项目理解（2小时）

#### 2.1 阅读核心文档
```
📖 必读文档列表：
├── docs/中道商城系统功能规划.md    # 核心业务逻辑（重点！）
├── docs/AI协同开发指南.md           # 协作开发规范
├── docs/环境管理与部署指南.md       # 环境配置指南
├── general.mdc                     # AI开发约束（重要！）
└── README.md                       # 项目概览
```

#### 2.2 理解业务关键点

**🎯 业务关键理解点（必须掌握）：**

1. **用户等级升级逻辑**：
   - 双维度判断：销量要求 + 团队要求
   - 销量计算：总销售额 ÷ 599元（向下取整）
   - 团队要求：必须有对应数量的直推下级

2. **采购权限规则**：
   - 只能向更高级别且非平级的上级进货
   - 采购价格由**买方**等级决定
   - 中间人业绩计算和佣金分配

3. **双店铺差异化**：
   - 云店：基于销量累积升级
   - 五通店：一次性27,000元，买10赠1权益

4. **库存流转规则**：
   - 云仓：团队共享，不可退货
   - 本地仓：个人独有，支持退货
   - 只能从云仓→本地仓单向流转

5. **通券流转安全**：
   - 所有操作必须使用数据库事务
   - 完整流水记录用于审计
   - 支持多源流转（进货/转账/充值）

### Step 3: 开发工具配置（30分钟）

#### 3.1 VS Code扩展安装
```json
// 必需扩展
{
  "recommendations": [
    "ms-vscode.vscode-typescript-next",
    "prisma.prisma",
    "esbenp.prettier-vscode",
    "dbaeumer.vscode-eslint",
    "ms-vscode.vscode-json",
    "bradlc.vscode-tailwindcss",
    "ms-vscode.test-adapter-converter"
  ]
}
```

#### 3.2 Git配置
```bash
# 配置Git用户信息
git config --global user.name "Your Name"
git config --global user.email "your.email@example.com"

# 设置默认分支名
git config --global init.defaultBranch main

# 配置自动换行符
git config --global core.autocrlf input
```

#### 3.3 开发环境验证
```bash
# 运行测试套件
npm test

# 代码风格检查
npm run lint

# TypeScript编译检查
npm run type-check
```

### Step 4: AI协同系统熟悉（1小时）

#### 4.1 了解AI角色分工
| AI角色 | ID | 专业领域 | 联系方式 |
|--------|-----|----------|----------|
| 协调AI | coordinator-ai-1 | 项目管理、任务分配 | 通过任务系统 |
| 架构师AI | architect-ai-1 | 系统设计、技术决策 | 通过任务系统 |
| 用户系统AI | developer-ai-1 | 用户管理、认证授权 | 通过任务系统 |
| 店铺系统AI | developer-ai-2 | 店铺管理、库存订单 | 通过任务系统 |
| 测试AI | testing-ai-1 | 质量保证、测试策略 | 通过任务系统 |
| 文档AI | documentation-ai-1 | 技术文档、用户手册 | 通过任务系统 |

#### 4.2 使用协同工具
```bash
# 查看当前任务
npx ts-node scripts/ai-collaboration.ts tasks

# 查看AI状态
npx ts-node scripts/ai-collaboration.ts ai-status

# 搜索知识库
npx ts-node scripts/ai-collaboration.ts search-knowledge "用户等级"

# 创建新任务（如果需要）
npx ts-node scripts/ai-collaboration.ts create-task \
  --title "你的任务标题" \
  --description "详细描述" \
  --priority medium
```

### Step 5: 代码规范掌握（30分钟）

#### 5.1 必须遵守的约束（来自general.mdc）

**❌ 绝对不能违反的业务规则：**
- 用户等级定义不能修改
- 采购权限规则必须严格执行
- 双店铺逻辑不能混淆
- 库存流转规则必须遵守

**✅ 必须遵循的技术规范：**
- TypeScript严格模式
- 所有业务操作使用事务
- 错误处理必须完整
- 测试覆盖率达标

#### 5.2 代码风格检查
```bash
# 运行完整的代码检查
npm run lint:fix
npm run type-check
npm run test:coverage
```

### Step 6: 第一个任务（1-2小时）

#### 6.1 获取你的第一个任务
```bash
# 查看已分配给你的任务
npx ts-node scripts/ai-collaboration.ts tasks --status in_progress

# 如果没有任务，可以主动申请
npx ts-node scripts/ai-collaboration.ts create-task \
  --title "熟悉项目代码结构" \
  --description "分析现有代码结构，理解业务逻辑实现" \
  --priority low
```

#### 6.2 开始工作流程
1. **理解任务**：仔细阅读任务描述和要求
2. **查阅知识库**：搜索相关知识条目
3. **设计方案**：在脑海中或草稿纸上设计实现方案
4. **编码实现**：遵循代码规范进行开发
5. **自我测试**：运行单元测试确保功能正确
6. **更新任务状态**：标记为completed
7. **记录经验**：添加新的知识条目到知识库

---

## 🛠️ 日常开发工作流

### 每日开发流程

#### 早上开始工作时（5分钟）
```bash
# 1. 拉取最新代码
git pull origin main

# 2. 查看AI协同状态
./scripts/start-collaboration.sh status

# 3. 检查自己的任务
npx ts-node scripts/ai-collaboration.ts tasks
```

#### 开发过程中
```bash
# 频繁保存进度
git add .
git commit -m "feat: 实现xxx功能"

# 定期运行测试
npm test

# 遇到问题先搜索知识库
npx ts-node scripts/ai-collaboration.ts search-knowledge "关键词"
```

#### 结束工作时（5分钟）
```bash
# 1. 提交当日代码
git add .
git commit -m "feat: 完成当日开发任务"
git push origin main

# 2. 更新任务状态
npx ts-node scripts/ai-collaboration.ts update-task <taskId> completed

# 3. 记录今日经验
npx ts-node scripts/ai-collaboration.ts add-knowledge \
  --title "今日解决的问题" \
  --content "详细描述解决方案" \
  --type "lesson_learned"
```

### 协作沟通规范

#### 与其他AI协作
- ✅ **主动沟通**：遇到问题及时通过任务系统沟通
- ✅ **尊重专业**：尊重其他AI的专业领域和建议
- ✅ **及时响应**：在24小时内响应协作请求
- ❌ **绕过系统**：不私下修改其他AI负责的代码

#### 与人类开发者协作
- ✅ **清晰沟通**：使用清晰、简洁的语言
- ✅ **提供上下文**：提供足够的背景信息
- ✅ **接受反馈**：虚心接受代码审查和建议
- ❌ **过度技术化**：避免使用过于专业的术语

---

## 🚨 常见问题解决

### 环境问题

**Q: Docker启动失败**
```bash
# 解决方案
docker-compose down
docker system prune -f
docker-compose up -d
```

**Q: 数据库连接失败**
```bash
# 检查数据库状态
docker-compose ps

# 重启数据库
docker-compose restart mysql

# 检查环境配置
./scripts/env-manager.sh status
```

### 开发问题

**Q: TypeScript编译错误**
```bash
# 解决方案
npm run type-check
# 根据错误信息修复类型问题
```

**Q: 测试失败**
```bash
# 运行特定测试
npm test -- --testNamePattern="failed_test"

# 查看详细错误信息
npm test -- --verbose
```

### 协作问题

**Q: 任务冲突**
```bash
# 检测冲突
npx ts-node scripts/ai-collaboration.ts detect-conflicts

# 联系协调AI
# 在任务中添加评论说明冲突情况
```

**Q: 需要帮助**
```bash
# 在任务中标记为blocked
npx ts-node scripts/ai-collaboration.ts update-task <taskId> blocked

# 联系协调AI
# 协调AI会协调其他AI提供帮助
```

---

## 📞 获取帮助

### 项目支持渠道

1. **文档优先**：首先查阅项目文档
2. **AI协同系统**：通过任务系统联系相关AI
3. **GitHub Issues**：报告bug或提出功能请求
4. **团队群聊**：紧急问题联系团队

### 必读文档清单

- ✅ [ ] 中道商城系统功能规划.md
- ✅ [ ] AI协同开发指南.md
- ✅ [ ] 环境管理与部署指南.md
- ✅ [ ] general.mdc（AI开发约束）
- ✅ [ ] 本项目启动手册

### 检查清单

在开始正式开发前，请确认以下项目：

- [ ] 开发环境已启动并验证
- [ ] 已阅读所有必读文档
- [ ] 理解核心业务逻辑
- [ ] 熟悉协同工具使用
- [ ] 掌握代码规范和约束
- [ ] 已获取第一个任务
- [ ] 了解日常工作流程

---

## 🎉 开始你的旅程

恭喜！你已经完成了项目启动的所有准备工作。现在：

1. **领取你的第一个任务**
2. **开始编写代码**
3. **与AI团队协作**
4. **享受开发过程**

记住：
- 🤖 你不是一个人在战斗，有AI团队支持
- 📚 遇到问题先查阅文档和知识库
- 🛠️ 遵循代码规范和业务约束
- 🔄 积极沟通，分享经验和知识

**祝你开发愉快！🚀**

---

**重要提醒**：
- 业务逻辑是项目的核心，必须严格遵循功能规划
- 遇到不确定的地方，先询问再动手
- 代码质量比开发速度更重要
- 每天的经验都是宝贵的财富，记得记录和分享