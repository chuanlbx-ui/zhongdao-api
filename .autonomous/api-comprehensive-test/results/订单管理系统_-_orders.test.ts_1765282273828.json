{
  "name": "订单管理系统 - orders.test.ts",
  "command": "npm test tests/api/orders.test.ts",
  "startTime": "2025-12-09T12:11:09.280Z",
  "status": "failed",
  "output": "",
  "error": "Command failed: npm test tests/api/orders.test.ts\n\n\u001b[31m⎯⎯⎯⎯⎯⎯\u001b[39m\u001b[1m\u001b[41m Failed Tests 20 \u001b[49m\u001b[22m\u001b[31m⎯⎯⎯⎯⎯⎯⎯\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m api/orders.test.ts\u001b[2m > \u001b[22m订单管理API测试\u001b[2m > \u001b[22mGET /orders\u001b[2m > \u001b[22m应该能够获取订单模块信息\n\u001b[31m\u001b[1mError\u001b[22m: expected 200 \"OK\", got 401 \"Unauthorized\"\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m api/orders.test.ts:\u001b[2m31:10\u001b[22m\u001b[39m\n    \u001b[90m 29| \u001b[39m      \u001b[35mconst\u001b[39m response \u001b[33m=\u001b[39m \u001b[35mawait\u001b[39m \u001b[34mrequest\u001b[39m(app)\n    \u001b[90m 30| \u001b[39m        \u001b[33m.\u001b[39m\u001b[35mget\u001b[39m(\u001b[32m`\u001b[39m\u001b[36m${\u001b[39m\u001b[33mAPI_BASE\u001b[39m\u001b[36m}\u001b[39m\u001b[32m/orders`\u001b[39m)\n    \u001b[90m 31| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mexpect\u001b[39m(\u001b[34m200\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[90m   | \u001b[39m         \u001b[31m^\u001b[39m\n    \u001b[90m 32| \u001b[39m\n    \u001b[90m 33| \u001b[39m      \u001b[34mexpect\u001b[39m(response\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39msuccess)\u001b[33m.\u001b[39m\u001b[34mtoBe\u001b[39m(\u001b[35mtrue\u001b[39m)\u001b[33m;\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertStatus ../node_modules/supertest/lib/test.js:\u001b[2m309:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m ../node_modules/supertest/lib/test.js:\u001b[2m365:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertFunction ../node_modules/supertest/lib/test.js:\u001b[2m342:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test.assert ../node_modules/supertest/lib/test.js:\u001b[2m195:23\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m localAssert ../node_modules/supertest/lib/test.js:\u001b[2m138:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Server.<anonymous> ../node_modules/supertest/lib/test.js:\u001b[2m152:11\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/20]⎯\u001b[22m\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m api/orders.test.ts\u001b[2m > \u001b[22m订单管理API测试\u001b[2m > \u001b[22mGET /orders\u001b[2m > \u001b[22m应该能够获取订单列表\n\u001b[31m\u001b[1mError\u001b[22m: expected 200 \"OK\", got 401 \"Unauthorized\"\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m api/orders.test.ts:\u001b[2m46:10\u001b[22m\u001b[39m\n    \u001b[90m 44| \u001b[39m          perPage\u001b[33m:\u001b[39m \u001b[34m10\u001b[39m\n    \u001b[90m 45| \u001b[39m        })\n    \u001b[90m 46| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mexpect\u001b[39m(\u001b[34m200\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[90m   | \u001b[39m         \u001b[31m^\u001b[39m\n    \u001b[90m 47| \u001b[39m\n    \u001b[90m 48| \u001b[39m      \u001b[34mexpect\u001b[39m(response\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39msuccess)\u001b[33m.\u001b[39m\u001b[34mtoBe\u001b[39m(\u001b[35mtrue\u001b[39m)\u001b[33m;\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertStatus ../node_modules/supertest/lib/test.js:\u001b[2m309:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m ../node_modules/supertest/lib/test.js:\u001b[2m365:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertFunction ../node_modules/supertest/lib/test.js:\u001b[2m342:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test.assert ../node_modules/supertest/lib/test.js:\u001b[2m195:23\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m localAssert ../node_modules/supertest/lib/test.js:\u001b[2m138:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Server.<anonymous> ../node_modules/supertest/lib/test.js:\u001b[2m152:11\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/20]⎯\u001b[22m\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m api/orders.test.ts\u001b[2m > \u001b[22m订单管理API测试\u001b[2m > \u001b[22mGET /orders\u001b[2m > \u001b[22m应该能够按状态筛选订单\n\u001b[31m\u001b[1mError\u001b[22m: expected 200 \"OK\", got 401 \"Unauthorized\"\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m api/orders.test.ts:\u001b[2m65:10\u001b[22m\u001b[39m\n    \u001b[90m 63| \u001b[39m          status\u001b[33m:\u001b[39m \u001b[32m'PENDING'\u001b[39m\n    \u001b[90m 64| \u001b[39m        })\n    \u001b[90m 65| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mexpect\u001b[39m(\u001b[34m200\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[90m   | \u001b[39m         \u001b[31m^\u001b[39m\n    \u001b[90m 66| \u001b[39m\n    \u001b[90m 67| \u001b[39m      \u001b[34mexpect\u001b[39m(response\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39msuccess)\u001b[33m.\u001b[39m\u001b[34mtoBe\u001b[39m(\u001b[35mtrue\u001b[39m)\u001b[33m;\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertStatus ../node_modules/supertest/lib/test.js:\u001b[2m309:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m ../node_modules/supertest/lib/test.js:\u001b[2m365:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertFunction ../node_modules/supertest/lib/test.js:\u001b[2m342:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test.assert ../node_modules/supertest/lib/test.js:\u001b[2m195:23\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m localAssert ../node_modules/supertest/lib/test.js:\u001b[2m138:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Server.<anonymous> ../node_modules/supertest/lib/test.js:\u001b[2m152:11\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/20]⎯\u001b[22m\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m api/orders.test.ts\u001b[2m > \u001b[22m订单管理API测试\u001b[2m > \u001b[22mGET /orders\u001b[2m > \u001b[22m应该能够按支付状态筛选订单\n\u001b[31m\u001b[1mError\u001b[22m: expected 200 \"OK\", got 401 \"Unauthorized\"\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m api/orders.test.ts:\u001b[2m84:10\u001b[22m\u001b[39m\n    \u001b[90m 82| \u001b[39m          paymentStatus\u001b[33m:\u001b[39m \u001b[32m'UNPAID'\u001b[39m\n    \u001b[90m 83| \u001b[39m        })\n    \u001b[90m 84| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mexpect\u001b[39m(\u001b[34m200\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[90m   | \u001b[39m         \u001b[31m^\u001b[39m\n    \u001b[90m 85| \u001b[39m\n    \u001b[90m 86| \u001b[39m      \u001b[34mexpect\u001b[39m(response\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39msuccess)\u001b[33m.\u001b[39m\u001b[34mtoBe\u001b[39m(\u001b[35mtrue\u001b[39m)\u001b[33m;\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertStatus ../node_modules/supertest/lib/test.js:\u001b[2m309:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m ../node_modules/supertest/lib/test.js:\u001b[2m365:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertFunction ../node_modules/supertest/lib/test.js:\u001b[2m342:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test.assert ../node_modules/supertest/lib/test.js:\u001b[2m195:23\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m localAssert ../node_modules/supertest/lib/test.js:\u001b[2m138:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Server.<anonymous> ../node_modules/supertest/lib/test.js:\u001b[2m152:11\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/20]⎯\u001b[22m\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m api/orders.test.ts\u001b[2m > \u001b[22m订单管理API测试\u001b[2m > \u001b[22mGET /orders\u001b[2m > \u001b[22m应该能够按时间范围筛选订单\n\u001b[31m\u001b[1mError\u001b[22m: expected 200 \"OK\", got 401 \"Unauthorized\"\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m api/orders.test.ts:\u001b[2m103:10\u001b[22m\u001b[39m\n    \u001b[90m101| \u001b[39m          endDate\u001b[33m:\u001b[39m endDate\u001b[33m.\u001b[39m\u001b[34mtoISOString\u001b[39m()\n    \u001b[90m102| \u001b[39m        })\n    \u001b[90m103| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mexpect\u001b[39m(\u001b[34m200\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[90m   | \u001b[39m         \u001b[31m^\u001b[39m\n    \u001b[90m104| \u001b[39m\n    \u001b[90m105| \u001b[39m      \u001b[34mexpect\u001b[39m(response\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39msuccess)\u001b[33m.\u001b[39m\u001b[34mtoBe\u001b[39m(\u001b[35mtrue\u001b[39m)\u001b[33m;\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertStatus ../node_modules/supertest/lib/test.js:\u001b[2m309:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m ../node_modules/supertest/lib/test.js:\u001b[2m365:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertFunction ../node_modules/supertest/lib/test.js:\u001b[2m342:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test.assert ../node_modules/supertest/lib/test.js:\u001b[2m195:23\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m localAssert ../node_modules/supertest/lib/test.js:\u001b[2m138:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Server.<anonymous> ../node_modules/supertest/lib/test.js:\u001b[2m152:11\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/20]⎯\u001b[22m\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m api/orders.test.ts\u001b[2m > \u001b[22m订单管理API测试\u001b[2m > \u001b[22mPOST /orders\u001b[2m > \u001b[22m应该能够创建新订单\n\u001b[31m\u001b[1mError\u001b[22m: expected 200 \"OK\", got 401 \"Unauthorized\"\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m api/orders.test.ts:\u001b[2m128:10\u001b[22m\u001b[39m\n    \u001b[90m126| \u001b[39m        \u001b[33m.\u001b[39m\u001b[35mset\u001b[39m(\u001b[32m'Authorization'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m`Bearer \u001b[39m\u001b[36m${\u001b[39muserToken\u001b[36m}\u001b[39m\u001b[32m`\u001b[39m)\n    \u001b[90m127| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34msend\u001b[39m(orderData)\n    \u001b[90m128| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mexpect\u001b[39m(\u001b[34m200\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[90m   | \u001b[39m         \u001b[31m^\u001b[39m\n    \u001b[90m129| \u001b[39m\n    \u001b[90m130| \u001b[39m      \u001b[34mexpect\u001b[39m(response\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39msuccess)\u001b[33m.\u001b[39m\u001b[34mtoBe\u001b[39m(\u001b[35mtrue\u001b[39m)\u001b[33m;\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertStatus ../node_modules/supertest/lib/test.js:\u001b[2m309:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m ../node_modules/supertest/lib/test.js:\u001b[2m365:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertFunction ../node_modules/supertest/lib/test.js:\u001b[2m342:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test.assert ../node_modules/supertest/lib/test.js:\u001b[2m195:23\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m localAssert ../node_modules/supertest/lib/test.js:\u001b[2m138:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Server.<anonymous> ../node_modules/supertest/lib/test.js:\u001b[2m152:11\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/20]⎯\u001b[22m\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m api/orders.test.ts\u001b[2m > \u001b[22m订单管理API测试\u001b[2m > \u001b[22mPOST /orders\u001b[2m > \u001b[22m应该拒绝空的订单项\n\u001b[31m\u001b[1mError\u001b[22m: expected 400 \"Bad Request\", got 401 \"Unauthorized\"\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m api/orders.test.ts:\u001b[2m152:10\u001b[22m\u001b[39m\n    \u001b[90m150| \u001b[39m        \u001b[33m.\u001b[39m\u001b[35mset\u001b[39m(\u001b[32m'Authorization'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m`Bearer \u001b[39m\u001b[36m${\u001b[39muserToken\u001b[36m}\u001b[39m\u001b[32m`\u001b[39m)\n    \u001b[90m151| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34msend\u001b[39m(orderData)\n    \u001b[90m152| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mexpect\u001b[39m(\u001b[34m400\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[90m   | \u001b[39m         \u001b[31m^\u001b[39m\n    \u001b[90m153| \u001b[39m\n    \u001b[90m154| \u001b[39m      \u001b[34mexpect\u001b[39m(response\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39msuccess)\u001b[33m.\u001b[39m\u001b[34mtoBe\u001b[39m(\u001b[35mfalse\u001b[39m)\u001b[33m;\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertStatus ../node_modules/supertest/lib/test.js:\u001b[2m309:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m ../node_modules/supertest/lib/test.js:\u001b[2m365:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertFunction ../node_modules/supertest/lib/test.js:\u001b[2m342:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test.assert ../node_modules/supertest/lib/test.js:\u001b[2m195:23\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m localAssert ../node_modules/supertest/lib/test.js:\u001b[2m138:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Server.<anonymous> ../node_modules/supertest/lib/test.js:\u001b[2m152:11\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/20]⎯\u001b[22m\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m api/orders.test.ts\u001b[2m > \u001b[22m订单管理API测试\u001b[2m > \u001b[22mPOST /orders\u001b[2m > \u001b[22m应该拒绝无效的支付方式\n\u001b[31m\u001b[1mError\u001b[22m: expected 400 \"Bad Request\", got 401 \"Unauthorized\"\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m api/orders.test.ts:\u001b[2m175:10\u001b[22m\u001b[39m\n    \u001b[90m173| \u001b[39m        \u001b[33m.\u001b[39m\u001b[35mset\u001b[39m(\u001b[32m'Authorization'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m`Bearer \u001b[39m\u001b[36m${\u001b[39muserToken\u001b[36m}\u001b[39m\u001b[32m`\u001b[39m)\n    \u001b[90m174| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34msend\u001b[39m(orderData)\n    \u001b[90m175| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mexpect\u001b[39m(\u001b[34m400\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[90m   | \u001b[39m         \u001b[31m^\u001b[39m\n    \u001b[90m176| \u001b[39m\n    \u001b[90m177| \u001b[39m      \u001b[34mexpect\u001b[39m(response\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39msuccess)\u001b[33m.\u001b[39m\u001b[34mtoBe\u001b[39m(\u001b[35mfalse\u001b[39m)\u001b[33m;\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertStatus ../node_modules/supertest/lib/test.js:\u001b[2m309:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m ../node_modules/supertest/lib/test.js:\u001b[2m365:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertFunction ../node_modules/supertest/lib/test.js:\u001b[2m342:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test.assert ../node_modules/supertest/lib/test.js:\u001b[2m195:23\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m localAssert ../node_modules/supertest/lib/test.js:\u001b[2m138:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Server.<anonymous> ../node_modules/supertest/lib/test.js:\u001b[2m152:11\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/20]⎯\u001b[22m\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m api/orders.test.ts\u001b[2m > \u001b[22m订单管理API测试\u001b[2m > \u001b[22mPOST /orders\u001b[2m > \u001b[22m应该拒绝数量为0的商品\n\u001b[31m\u001b[1mError\u001b[22m: expected 400 \"Bad Request\", got 401 \"Unauthorized\"\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m api/orders.test.ts:\u001b[2m197:10\u001b[22m\u001b[39m\n    \u001b[90m195| \u001b[39m        \u001b[33m.\u001b[39m\u001b[35mset\u001b[39m(\u001b[32m'Authorization'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m`Bearer \u001b[39m\u001b[36m${\u001b[39muserToken\u001b[36m}\u001b[39m\u001b[32m`\u001b[39m)\n    \u001b[90m196| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34msend\u001b[39m(orderData)\n    \u001b[90m197| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mexpect\u001b[39m(\u001b[34m400\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[90m   | \u001b[39m         \u001b[31m^\u001b[39m\n    \u001b[90m198| \u001b[39m\n    \u001b[90m199| \u001b[39m      \u001b[34mexpect\u001b[39m(response\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39msuccess)\u001b[33m.\u001b[39m\u001b[34mtoBe\u001b[39m(\u001b[35mfalse\u001b[39m)\u001b[33m;\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertStatus ../node_modules/supertest/lib/test.js:\u001b[2m309:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m ../node_modules/supertest/lib/test.js:\u001b[2m365:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertFunction ../node_modules/supertest/lib/test.js:\u001b[2m342:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test.assert ../node_modules/supertest/lib/test.js:\u001b[2m195:23\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m localAssert ../node_modules/supertest/lib/test.js:\u001b[2m138:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Server.<anonymous> ../node_modules/supertest/lib/test.js:\u001b[2m152:11\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/20]⎯\u001b[22m\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m api/orders.test.ts\u001b[2m > \u001b[22m订单管理API测试\u001b[2m > \u001b[22mGET /orders/:orderId\u001b[2m > \u001b[22m应该返回404当订单不存在\n\u001b[31m\u001b[1mError\u001b[22m: expected 404 \"Not Found\", got 401 \"Unauthorized\"\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m api/orders.test.ts:\u001b[2m230:10\u001b[22m\u001b[39m\n    \u001b[90m228| \u001b[39m        \u001b[33m.\u001b[39m\u001b[35mget\u001b[39m(\u001b[32m`\u001b[39m\u001b[36m${\u001b[39m\u001b[33mAPI_BASE\u001b[39m\u001b[36m}\u001b[39m\u001b[32m/orders/\u001b[39m\u001b[36m${\u001b[39mfakeOrderId\u001b[36m}\u001b[39m\u001b[32m`\u001b[39m)\n    \u001b[90m229| \u001b[39m        \u001b[33m.\u001b[39m\u001b[35mset\u001b[39m(\u001b[32m'Authorization'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m`Bearer \u001b[39m\u001b[36m${\u001b[39muserToken\u001b[36m}\u001b[39m\u001b[32m`\u001b[39m)\n    \u001b[90m230| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mexpect\u001b[39m(\u001b[34m404\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[90m   | \u001b[39m         \u001b[31m^\u001b[39m\n    \u001b[90m231| \u001b[39m\n    \u001b[90m232| \u001b[39m      \u001b[34mexpect\u001b[39m(response\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39msuccess)\u001b[33m.\u001b[39m\u001b[34mtoBe\u001b[39m(\u001b[35mfalse\u001b[39m)\u001b[33m;\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertStatus ../node_modules/supertest/lib/test.js:\u001b[2m309:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m ../node_modules/supertest/lib/test.js:\u001b[2m365:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertFunction ../node_modules/supertest/lib/test.js:\u001b[2m342:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test.assert ../node_modules/supertest/lib/test.js:\u001b[2m195:23\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m localAssert ../node_modules/supertest/lib/test.js:\u001b[2m138:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Server.<anonymous> ../node_modules/supertest/lib/test.js:\u001b[2m152:11\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/20]⎯\u001b[22m\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m api/orders.test.ts\u001b[2m > \u001b[22m订单管理API测试\u001b[2m > \u001b[22mPUT /orders/:orderId/confirm\u001b[2m > \u001b[22m应该拒绝确认已取消的订单\n\u001b[31m\u001b[1mError\u001b[22m: expected 400 \"Bad Request\", got 415 \"Unsupported Media Type\"\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m api/orders.test.ts:\u001b[2m273:10\u001b[22m\u001b[39m\n    \u001b[90m271| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mput\u001b[39m(\u001b[32m`\u001b[39m\u001b[36m${\u001b[39m\u001b[33mAPI_BASE\u001b[39m\u001b[36m}\u001b[39m\u001b[32m/orders/\u001b[39m\u001b[36m${\u001b[39mcancelledOrderId\u001b[36m}\u001b[39m\u001b[32m/confirm`\u001b[39m)\n    \u001b[90m272| \u001b[39m        \u001b[33m.\u001b[39m\u001b[35mset\u001b[39m(\u001b[32m'Authorization'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m`Bearer \u001b[39m\u001b[36m${\u001b[39muserToken\u001b[36m}\u001b[39m\u001b[32m`\u001b[39m)\n    \u001b[90m273| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mexpect\u001b[39m(\u001b[34m400\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[90m   | \u001b[39m         \u001b[31m^\u001b[39m\n    \u001b[90m274| \u001b[39m\n    \u001b[90m275| \u001b[39m      \u001b[34mexpect\u001b[39m(response\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39msuccess)\u001b[33m.\u001b[39m\u001b[34mtoBe\u001b[39m(\u001b[35mfalse\u001b[39m)\u001b[33m;\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertStatus ../node_modules/supertest/lib/test.js:\u001b[2m309:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m ../node_modules/supertest/lib/test.js:\u001b[2m365:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertFunction ../node_modules/supertest/lib/test.js:\u001b[2m342:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test.assert ../node_modules/supertest/lib/test.js:\u001b[2m195:23\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m localAssert ../node_modules/supertest/lib/test.js:\u001b[2m138:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Server.<anonymous> ../node_modules/supertest/lib/test.js:\u001b[2m152:11\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/20]⎯\u001b[22m\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m api/orders.test.ts\u001b[2m > \u001b[22m订单管理API测试\u001b[2m > \u001b[22mPUT /orders/:orderId/cancel\u001b[2m > \u001b[22m应该能够取消订单\n\u001b[31m\u001b[1mError\u001b[22m: expected 200 \"OK\", got 401 \"Unauthorized\"\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m api/orders.test.ts:\u001b[2m299:10\u001b[22m\u001b[39m\n    \u001b[90m297| \u001b[39m        \u001b[33m.\u001b[39m\u001b[35mset\u001b[39m(\u001b[32m'Authorization'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m`Bearer \u001b[39m\u001b[36m${\u001b[39muserToken\u001b[36m}\u001b[39m\u001b[32m`\u001b[39m)\n    \u001b[90m298| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34msend\u001b[39m(orderData)\n    \u001b[90m299| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mexpect\u001b[39m(\u001b[34m200\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[90m   | \u001b[39m         \u001b[31m^\u001b[39m\n    \u001b[90m300| \u001b[39m\n    \u001b[90m301| \u001b[39m      \u001b[35mconst\u001b[39m cancelResponse \u001b[33m=\u001b[39m \u001b[35mawait\u001b[39m \u001b[34mrequest\u001b[39m(app)\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertStatus ../node_modules/supertest/lib/test.js:\u001b[2m309:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m ../node_modules/supertest/lib/test.js:\u001b[2m365:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertFunction ../node_modules/supertest/lib/test.js:\u001b[2m342:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test.assert ../node_modules/supertest/lib/test.js:\u001b[2m195:23\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m localAssert ../node_modules/supertest/lib/test.js:\u001b[2m138:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Server.<anonymous> ../node_modules/supertest/lib/test.js:\u001b[2m152:11\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/20]⎯\u001b[22m\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m api/orders.test.ts\u001b[2m > \u001b[22m订单管理API测试\u001b[2m > \u001b[22mPUT /orders/:orderId/cancel\u001b[2m > \u001b[22m应该拒绝取消已完成的订单\n\u001b[31m\u001b[1mError\u001b[22m: expected 400 \"Bad Request\", got 415 \"Unsupported Media Type\"\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m api/orders.test.ts:\u001b[2m316:10\u001b[22m\u001b[39m\n    \u001b[90m314| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mput\u001b[39m(\u001b[32m`\u001b[39m\u001b[36m${\u001b[39m\u001b[33mAPI_BASE\u001b[39m\u001b[36m}\u001b[39m\u001b[32m/orders/\u001b[39m\u001b[36m${\u001b[39mcompletedOrderId\u001b[36m}\u001b[39m\u001b[32m/cancel`\u001b[39m)\n    \u001b[90m315| \u001b[39m        \u001b[33m.\u001b[39m\u001b[35mset\u001b[39m(\u001b[32m'Authorization'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m`Bearer \u001b[39m\u001b[36m${\u001b[39muserToken\u001b[36m}\u001b[39m\u001b[32m`\u001b[39m)\n    \u001b[90m316| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mexpect\u001b[39m(\u001b[34m400\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[90m   | \u001b[39m         \u001b[31m^\u001b[39m\n    \u001b[90m317| \u001b[39m\n    \u001b[90m318| \u001b[39m      \u001b[34mexpect\u001b[39m(response\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39msuccess)\u001b[33m.\u001b[39m\u001b[34mtoBe\u001b[39m(\u001b[35mfalse\u001b[39m)\u001b[33m;\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertStatus ../node_modules/supertest/lib/test.js:\u001b[2m309:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m ../node_modules/supertest/lib/test.js:\u001b[2m365:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertFunction ../node_modules/supertest/lib/test.js:\u001b[2m342:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test.assert ../node_modules/supertest/lib/test.js:\u001b[2m195:23\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m localAssert ../node_modules/supertest/lib/test.js:\u001b[2m138:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Server.<anonymous> ../node_modules/supertest/lib/test.js:\u001b[2m152:11\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/20]⎯\u001b[22m\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m api/orders.test.ts\u001b[2m > \u001b[22m订单管理API测试\u001b[2m > \u001b[22mPUT /orders/:orderId/cancel\u001b[2m > \u001b[22m应该提供取消原因\n\u001b[31m\u001b[1mError\u001b[22m: expected 200 \"OK\", got 401 \"Unauthorized\"\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m api/orders.test.ts:\u001b[2m339:10\u001b[22m\u001b[39m\n    \u001b[90m337| \u001b[39m        \u001b[33m.\u001b[39m\u001b[35mset\u001b[39m(\u001b[32m'Authorization'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m`Bearer \u001b[39m\u001b[36m${\u001b[39muserToken\u001b[36m}\u001b[39m\u001b[32m`\u001b[39m)\n    \u001b[90m338| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34msend\u001b[39m(orderData)\n    \u001b[90m339| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mexpect\u001b[39m(\u001b[34m200\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[90m   | \u001b[39m         \u001b[31m^\u001b[39m\n    \u001b[90m340| \u001b[39m\n    \u001b[90m341| \u001b[39m      \u001b[35mconst\u001b[39m cancelResponse \u001b[33m=\u001b[39m \u001b[35mawait\u001b[39m \u001b[34mrequest\u001b[39m(app)\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertStatus ../node_modules/supertest/lib/test.js:\u001b[2m309:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m ../node_modules/supertest/lib/test.js:\u001b[2m365:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertFunction ../node_modules/supertest/lib/test.js:\u001b[2m342:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test.assert ../node_modules/supertest/lib/test.js:\u001b[2m195:23\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m localAssert ../node_modules/supertest/lib/test.js:\u001b[2m138:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Server.<anonymous> ../node_modules/supertest/lib/test.js:\u001b[2m152:11\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/20]⎯\u001b[22m\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m api/orders.test.ts\u001b[2m > \u001b[22m订单管理API测试\u001b[2m > \u001b[22m订单统计API\u001b[2m > \u001b[22m应该能够获取订单统计信息\n\u001b[31m\u001b[1mError\u001b[22m: expected 200 \"OK\", got 401 \"Unauthorized\"\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m api/orders.test.ts:\u001b[2m358:10\u001b[22m\u001b[39m\n    \u001b[90m356| \u001b[39m        \u001b[33m.\u001b[39m\u001b[35mget\u001b[39m(\u001b[32m`\u001b[39m\u001b[36m${\u001b[39m\u001b[33mAPI_BASE\u001b[39m\u001b[36m}\u001b[39m\u001b[32m/orders/statistics`\u001b[39m)\n    \u001b[90m357| \u001b[39m        \u001b[33m.\u001b[39m\u001b[35mset\u001b[39m(\u001b[32m'Authorization'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m`Bearer \u001b[39m\u001b[36m${\u001b[39muserToken\u001b[36m}\u001b[39m\u001b[32m`\u001b[39m)\n    \u001b[90m358| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mexpect\u001b[39m(\u001b[34m200\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[90m   | \u001b[39m         \u001b[31m^\u001b[39m\n    \u001b[90m359| \u001b[39m\n    \u001b[90m360| \u001b[39m      \u001b[34mexpect\u001b[39m(response\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39msuccess)\u001b[33m.\u001b[39m\u001b[34mtoBe\u001b[39m(\u001b[35mtrue\u001b[39m)\u001b[33m;\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertStatus ../node_modules/supertest/lib/test.js:\u001b[2m309:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m ../node_modules/supertest/lib/test.js:\u001b[2m365:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertFunction ../node_modules/supertest/lib/test.js:\u001b[2m342:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test.assert ../node_modules/supertest/lib/test.js:\u001b[2m195:23\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m localAssert ../node_modules/supertest/lib/test.js:\u001b[2m138:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Server.<anonymous> ../node_modules/supertest/lib/test.js:\u001b[2m152:11\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/20]⎯\u001b[22m\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m api/orders.test.ts\u001b[2m > \u001b[22m订单管理API测试\u001b[2m > \u001b[22m订单统计API\u001b[2m > \u001b[22m应该能够获取订单统计概览\n\u001b[31m\u001b[1mError\u001b[22m: expected 200 \"OK\", got 401 \"Unauthorized\"\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m api/orders.test.ts:\u001b[2m374:10\u001b[22m\u001b[39m\n    \u001b[90m372| \u001b[39m        \u001b[33m.\u001b[39m\u001b[35mget\u001b[39m(\u001b[32m`\u001b[39m\u001b[36m${\u001b[39m\u001b[33mAPI_BASE\u001b[39m\u001b[36m}\u001b[39m\u001b[32m/orders/statistics/overview`\u001b[39m)\n    \u001b[90m373| \u001b[39m        \u001b[33m.\u001b[39m\u001b[35mset\u001b[39m(\u001b[32m'Authorization'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m`Bearer \u001b[39m\u001b[36m${\u001b[39muserToken\u001b[36m}\u001b[39m\u001b[32m`\u001b[39m)\n    \u001b[90m374| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mexpect\u001b[39m(\u001b[34m200\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[90m   | \u001b[39m         \u001b[31m^\u001b[39m\n    \u001b[90m375| \u001b[39m\n    \u001b[90m376| \u001b[39m      \u001b[34mexpect\u001b[39m(response\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39msuccess)\u001b[33m.\u001b[39m\u001b[34mtoBe\u001b[39m(\u001b[35mtrue\u001b[39m)\u001b[33m;\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertStatus ../node_modules/supertest/lib/test.js:\u001b[2m309:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m ../node_modules/supertest/lib/test.js:\u001b[2m365:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertFunction ../node_modules/supertest/lib/test.js:\u001b[2m342:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test.assert ../node_modules/supertest/lib/test.js:\u001b[2m195:23\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m localAssert ../node_modules/supertest/lib/test.js:\u001b[2m138:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Server.<anonymous> ../node_modules/supertest/lib/test.js:\u001b[2m152:11\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/20]⎯\u001b[22m\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m api/orders.test.ts\u001b[2m > \u001b[22m订单管理API测试\u001b[2m > \u001b[22m订单统计API\u001b[2m > \u001b[22m应该能够按时间范围获取统计\n\u001b[31m\u001b[1mError\u001b[22m: expected 200 \"OK\", got 401 \"Unauthorized\"\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m api/orders.test.ts:\u001b[2m391:10\u001b[22m\u001b[39m\n    \u001b[90m389| \u001b[39m          endDate\u001b[33m:\u001b[39m \u001b[35mnew\u001b[39m \u001b[33mDate\u001b[39m()\u001b[33m.\u001b[39m\u001b[34mtoISOString\u001b[39m()\n    \u001b[90m390| \u001b[39m        })\n    \u001b[90m391| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mexpect\u001b[39m(\u001b[34m200\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[90m   | \u001b[39m         \u001b[31m^\u001b[39m\n    \u001b[90m392| \u001b[39m\n    \u001b[90m393| \u001b[39m      \u001b[34mexpect\u001b[39m(response\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39msuccess)\u001b[33m.\u001b[39m\u001b[34mtoBe\u001b[39m(\u001b[35mtrue\u001b[39m)\u001b[33m;\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertStatus ../node_modules/supertest/lib/test.js:\u001b[2m309:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m ../node_modules/supertest/lib/test.js:\u001b[2m365:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertFunction ../node_modules/supertest/lib/test.js:\u001b[2m342:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test.assert ../node_modules/supertest/lib/test.js:\u001b[2m195:23\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m localAssert ../node_modules/supertest/lib/test.js:\u001b[2m138:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Server.<anonymous> ../node_modules/supertest/lib/test.js:\u001b[2m152:11\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/20]⎯\u001b[22m\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m api/orders.test.ts\u001b[2m > \u001b[22m订单管理API测试\u001b[2m > \u001b[22m换货申请 API\u001b[2m > \u001b[22m应该拒绝无效的换货申请\n\u001b[31m\u001b[1mError\u001b[22m: expected 400 \"Bad Request\", got 401 \"Unauthorized\"\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m api/orders.test.ts:\u001b[2m439:10\u001b[22m\u001b[39m\n    \u001b[90m437| \u001b[39m        \u001b[33m.\u001b[39m\u001b[35mset\u001b[39m(\u001b[32m'Authorization'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m`Bearer \u001b[39m\u001b[36m${\u001b[39muserToken\u001b[36m}\u001b[39m\u001b[32m`\u001b[39m)\n    \u001b[90m438| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34msend\u001b[39m(exchangeData)\n    \u001b[90m439| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mexpect\u001b[39m(\u001b[34m400\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[90m   | \u001b[39m         \u001b[31m^\u001b[39m\n    \u001b[90m440| \u001b[39m\n    \u001b[90m441| \u001b[39m      \u001b[34mexpect\u001b[39m(response\u001b[33m.\u001b[39mbody\u001b[33m.\u001b[39msuccess)\u001b[33m.\u001b[39m\u001b[34mtoBe\u001b[39m(\u001b[35mfalse\u001b[39m)\u001b[33m;\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertStatus ../node_modules/supertest/lib/test.js:\u001b[2m309:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m ../node_modules/supertest/lib/test.js:\u001b[2m365:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertFunction ../node_modules/supertest/lib/test.js:\u001b[2m342:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test.assert ../node_modules/supertest/lib/test.js:\u001b[2m195:23\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m localAssert ../node_modules/supertest/lib/test.js:\u001b[2m138:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Server.<anonymous> ../node_modules/supertest/lib/test.js:\u001b[2m152:11\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/20]⎯\u001b[22m\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m api/orders.test.ts\u001b[2m > \u001b[22m订单管理API测试\u001b[2m > \u001b[22m订单权限和安全测试\u001b[2m > \u001b[22m应该阻止用户访问其他用户的订单\n\u001b[31m\u001b[1mError\u001b[22m: expected 200 \"OK\", got 401 \"Unauthorized\"\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m api/orders.test.ts:\u001b[2m464:10\u001b[22m\u001b[39m\n    \u001b[90m462| \u001b[39m        \u001b[33m.\u001b[39m\u001b[35mset\u001b[39m(\u001b[32m'Authorization'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m`Bearer \u001b[39m\u001b[36m${\u001b[39muserToken\u001b[36m}\u001b[39m\u001b[32m`\u001b[39m)\n    \u001b[90m463| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34msend\u001b[39m(orderData)\n    \u001b[90m464| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mexpect\u001b[39m(\u001b[34m200\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[90m   | \u001b[39m         \u001b[31m^\u001b[39m\n    \u001b[90m465| \u001b[39m\n    \u001b[90m466| \u001b[39m      \u001b[90m// 使用不同的token尝试访问\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertStatus ../node_modules/supertest/lib/test.js:\u001b[2m309:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m ../node_modules/supertest/lib/test.js:\u001b[2m365:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertFunction ../node_modules/supertest/lib/test.js:\u001b[2m342:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test.assert ../node_modules/supertest/lib/test.js:\u001b[2m195:23\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m localAssert ../node_modules/supertest/lib/test.js:\u001b[2m138:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Server.<anonymous> ../node_modules/supertest/lib/test.js:\u001b[2m152:11\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/20]⎯\u001b[22m\u001b[39m\n\n\u001b[41m\u001b[1m FAIL \u001b[22m\u001b[49m api/orders.test.ts\u001b[2m > \u001b[22m订单管理API测试\u001b[2m > \u001b[22m订单权限和安全测试\u001b[2m > \u001b[22m应该验证订单金额的正确性\n\u001b[31m\u001b[1mError\u001b[22m: expected 200 \"OK\", got 401 \"Unauthorized\"\u001b[39m\n\u001b[36m \u001b[2m❯\u001b[22m api/orders.test.ts:\u001b[2m500:10\u001b[22m\u001b[39m\n    \u001b[90m498| \u001b[39m        \u001b[33m.\u001b[39m\u001b[35mset\u001b[39m(\u001b[32m'Authorization'\u001b[39m\u001b[33m,\u001b[39m \u001b[32m`Bearer \u001b[39m\u001b[36m${\u001b[39muserToken\u001b[36m}\u001b[39m\u001b[32m`\u001b[39m)\n    \u001b[90m499| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34msend\u001b[39m(orderData)\n    \u001b[90m500| \u001b[39m        \u001b[33m.\u001b[39m\u001b[34mexpect\u001b[39m(\u001b[34m200\u001b[39m)\u001b[33m;\u001b[39m\n    \u001b[90m   | \u001b[39m         \u001b[31m^\u001b[39m\n    \u001b[90m501| \u001b[39m\n    \u001b[90m502| \u001b[39m      \u001b[35mconst\u001b[39m expectedTotal \u001b[33m=\u001b[39m (\u001b[34m2\u001b[39m \u001b[33m*\u001b[39m \u001b[34m100.00\u001b[39m) \u001b[33m+\u001b[39m (\u001b[34m3\u001b[39m \u001b[33m*\u001b[39m \u001b[34m50.00\u001b[39m)\u001b[33m;\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertStatus ../node_modules/supertest/lib/test.js:\u001b[2m309:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m ../node_modules/supertest/lib/test.js:\u001b[2m365:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test._assertFunction ../node_modules/supertest/lib/test.js:\u001b[2m342:13\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Test.assert ../node_modules/supertest/lib/test.js:\u001b[2m195:23\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m localAssert ../node_modules/supertest/lib/test.js:\u001b[2m138:14\u001b[22m\u001b[39m\n\u001b[90m \u001b[2m❯\u001b[22m Server.<anonymous> ../node_modules/supertest/lib/test.js:\u001b[2m152:11\u001b[22m\u001b[39m\n\n\u001b[31m\u001b[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/20]⎯\u001b[22m\u001b[39m\n\n",
  "endTime": "2025-12-09T12:11:13.828Z",
  "duration": 4548
}