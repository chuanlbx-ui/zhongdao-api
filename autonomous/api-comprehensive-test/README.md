# API综合测试平台 - 中道商城系统

这是一个专为中道商城系统设计的全面API测试平台，由多个AI智能体协同工作，确保所有API接口的完整性、可用性和安全性。

## 🎯 测试目标

- ✅ 验证所有API端点的功能正确性
- ✅ 检查业务逻辑实现的准确性
- ✅ 确保权限控制和安全机制有效
- ✅ 评估系统性能和并发处理能力
- ✅ 识别并记录所有潜在问题
- ✅ 生成详细的测试报告和修复建议

## 🤖 AI智能体团队

### 核心团队

| 智能体 | 角色 | 负责模块 |
|--------|------|----------|
| **PM-AI** | 项目经理 | 整体协调、任务分配、进度管理 |
| **Test-AI** | 测试专家 | 测试策略、用例设计、结果分析 |
| **User-API-AI** | 用户系统专家 | 认证、用户管理、团队关系 |
| **Shop-API-AI** | 商城系统专家 | 商品、订单、库存管理 |
| **Payment-API-AI** | 支付系统专家 | 积分、支付、佣金系统 |
| **Admin-API-AI** | 管理系统专家 | 后台管理、系统配置 |

### 支持团队

| 智能体 | 角色 | 专项负责 |
|--------|------|----------|
| **Security-AI** | 安全专家 | 漏洞扫描、安全测试 |
| **Performance-AI** | 性能专家 | 性能测试、负载测试 |
| **Documentation-AI** | 文档专家 | 报告生成、文档编写 |

## 🚀 快速开始

### 1. 运行所有测试

```bash
# 进入测试目录
cd .autonomous/api-comprehensive-test

# 运行完整测试套件
node run-tests

# 或者使用npm
npm run test:api:all
```

### 2. 运行特定模块

```bash
# 测试用户认证系统
node run-tests --module auth

# 测试商城系统
node run-tests --module shops

# 测试支付系统
node run-tests --module payments
```

### 3. 可用模块

- `auth` - 用户认证系统
- `users` - 用户管理系统
- `shops` - 商城管理系统
- `products` - 商品管理系统
- `orders` - 订单管理系统
- `points` - 积分系统
- `payments` - 支付系统
- `commission` - 佣金系统
- `admin` - 管理系统
- `security` - 安全测试
- `performance` - 性能测试
- `integration` - 集成测试

### 4. 高级选项

```bash
# 详细输出模式
node run-tests --verbose

# 跳过耗时的测试
node run-tests --skip-slow

# 仅显示测试计划（不执行）
node run-tests --dry-run

# 自定义超时时间（秒）
node run-tests --timeout 900

# 选择报告格式
node run-tests --reporter html
```

## 📊 测试报告

测试完成后，报告将保存在 `results/` 目录中：

- `test-report.html` - 可视化HTML报告
- `test-report.json` - 详细的JSON数据
- `[模块名]_[时间戳].json` - 各模块的详细结果

### 报告内容

1. **测试摘要**
   - 总测试数
   - 通过/失败数量
   - 通过率
   - 执行时间

2. **模块详情**
   - 每个模块的执行状态
   - 响应时间
   - 错误信息（如有）

3. **问题清单**
   - 发现的问题
   - 严重程度评估
   - 修复建议

4. **性能指标**
   - API响应时间
   - 并发处理能力
   - 资源使用情况

## 📋 测试执行计划

### Phase 1: 准备阶段 (2小时)
- [x] 环境检查和配置
- [x] 测试数据准备
- [x] 测试计划审查
- [x] 团队同步会议

### Phase 2: 执行阶段 (6小时)
- [ ] 核心API功能测试
- [ ] 业务逻辑验证
- [ ] 集成测试
- [ ] 错误处理测试

### Phase 3: 专项测试 (2小时)
- [ ] 安全漏洞扫描
- [ ] 性能基准测试
- [ ] 压力测试
- [ ] 并发测试

### Phase 4: 报告阶段 (2小时)
- [ ] 结果汇总分析
- [ ] 问题分类整理
- [ ] 报告编写
- [ ] 修复建议制定

## 🔧 自定义测试

### 添加新的测试模块

1. 在 `agent-tasks.json` 中定义新模块
2. 创建对应的测试文件
3. 更新 `run-tests.js` 中的模块配置

### 自定义测试用例

```javascript
// 在 tests/api/ 目录下创建新的测试文件
describe('新API测试', () => {
  it('应该正确响应', async () => {
    const response = await request(app)
      .get('/api/v1/new-endpoint')
      .expect(200);

    expect(response.body.success).toBe(true);
  });
});
```

## 📈 成功标准

- **覆盖率**: >95% API端点测试覆盖
- **通过率**: >80% 测试用例通过
- **响应时间**: <500ms (非复杂查询)
- **安全漏洞**: 0高危漏洞
- **文档完整性**: 100% 问题记录和修复建议

## 🐛 问题处理

### 常见问题

1. **测试超时**
   - 增加超时时间: `--timeout 1200`
   - 检查数据库连接

2. **权限错误**
   - 确认测试环境配置
   - 检查JWT令牌

3. **数据依赖**
   - 运行数据库种子: `npm run db:seed`
   - 清理测试数据

### 问题上报

发现问题时，请提供：
1. 完整的错误信息
2. 测试模块名称
3. 执行命令
4. 环境配置

## 📞 联系方式

- **项目负责人**: PM-AI
- **技术支持**: Test-AI
- **紧急问题**: @mentions

## 📝 更新日志

- **v1.0.0** - 初始版本，支持所有核心API测试
- 计划中：自动化修复建议、CI/CD集成、实时监控

---

**注意**: 本测试平台专为中道商城系统的复杂业务逻辑设计，在执行测试前请确保理解系统的多级用户体系和复杂的业务规则。