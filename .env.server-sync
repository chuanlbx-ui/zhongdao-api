# 中道商城系统 - 服务器同步环境配置
# 用于本地编译后部署到生产服务器
#
# 服务器信息：
# - API服务地址: https://zd-api.aierxin.com/
# - 数据库: 220.163.107.50:14306
# - 数据库名: zhongdao_mall

# ===========================================
# 基础配置（与服务器保持一致）
# ===========================================
NODE_ENV=production
PORT=3003
DEBUG=false

# ===========================================
# 数据库配置（服务器生产数据库）
# ===========================================
DATABASE_URL="mysql://root:mysql_qwe333666@220.163.107.50:14306/zhongdao_mall?connection_limit=20&pool_timeout=60&authPlugin=mysql_native_password"

DB_HOST=220.163.107.50
DB_PORT=14306
DB_USER=root
DB_PASSWORD=mysql_qwe333666
DB_NAME=zhongdao_mall

# 数据库连接池配置
DB_CONNECTION_LIMIT=20
DB_CONNECTION_TIMEOUT=60000
DB_ACQUIRE_TIMEOUT=60000

# ===========================================
# Redis缓存配置（生产环境暂不启用）
# ===========================================
# REDIS_URL="redis://your-redis-host:6379"
# REDIS_HOST=your-redis-host
# REDIS_PORT=6379
# REDIS_PASSWORD=
# REDIS_DB=0

# ===========================================
# JWT认证配置（必须与服务器一致）
# ===========================================
JWT_SECRET=7d8f9a2b4c6e1f3d5a7b9c2e4f6a8b1d3e5f7a9b2c4d6e8f1a3b5c7d9e2f4a6b8c1d3e5f7a9b2c4d6e8f1a3b5c7d9e
JWT_EXPIRES_IN=7d
JWT_REFRESH_EXPIRES_IN=30d

# JWT算法配置
JWT_ALGORITHM=HS256
JWT_ISSUER=zhongdao-mall-production
JWT_AUDIENCE=zhongdao-users

# ===========================================
# 微信小程序配置（生产）
# ===========================================
WECHAT_APP_ID=wx1ea1b1b0bf6bb19c
WECHAT_APP_SECRET=dd9a1e0b21c0dfb8614071f32bc61ded

# 微信登录配置
WECHAT_LOGIN_TIMEOUT=30000
WECHAT_TOKEN_EXPIRE=7200

# ===========================================
# 微信支付配置（生产）
# ===========================================
WECHAT_PAY_MERCHANT_ID=1623525309
WECHAT_PAY_API_KEY=7fK9qR2pY5vX3zW8nB6cD1mH4gJ7sL9kT
WECHAT_PAY_CERT_PATH=./certs/apiclient_cert.pem
WECHAT_PAY_KEY_PATH=./certs/apiclient_key.pem

# 支付回调URL（更新为新的域名）
WECHAT_PAY_NOTIFY_URL=https://zd-api.aierxin.com/api/v1/payments/wechat/notify
WECHAT_PAY_REFUND_NOTIFY_URL=https://zd-api.aierxin.com/api/v1/payments/wechat/refund-notify

# 关闭沙箱模式（生产必须）
WECHAT_SANDBOX=false

# ===========================================
# 文件上传配置
# ===========================================
UPLOAD_PATH=./uploads
MAX_FILE_SIZE=10485760
ALLOWED_FILE_TYPES=jpg,jpeg,png,gif,pdf,doc,docx

# 云存储配置（可选 - 建议生产使用腾讯云COS）
# TENCENT_COS_REGION=ap-guangzhou
# TENCENT_COS_BUCKET=your-bucket-name
# TENCENT_COS_SECRET_ID=your_secret_id
# TENCENT_COS_SECRET_KEY=your_secret_key

# ===========================================
# 邮件服务配置
# ===========================================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=chuanlbx@gmail.com
SMTP_PASS=simonYC6531))

EMAIL_FROM=noreply@zhongdao-mall.com
EMAIL_FROM_NAME=中道商城

# ===========================================
# 短信服务配置（可选）
# ===========================================
# TENCENT_SMS_SECRET_ID=your_secret_id
# TENCENT_SMS_SECRET_KEY=your_secret_key
# TENCENT_SMS_SDK_APP_ID=your_sdk_app_id
# TENCENT_SMS_SIGN_NAME=中道商城

# ===========================================
# 日志配置
# ===========================================
LOG_LEVEL=info
LOG_FILE=./logs/app.log

# 日志轮转配置
LOG_MAX_SIZE=10m
LOG_MAX_FILES=30
LOG_DATE_PATTERN=YYYY-MM-DD

# ===========================================
# 安全配置（生产严格控制）
# ===========================================
# CORS配置 - 仅允许生产前端域名
CORS_ORIGIN=https://zd-admin.aierxin.com,https://zd-h5.aierxin.com
CORS_CREDENTIALS=true
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_HEADERS=Content-Type,Authorization,X-CSRF-Token

# 限流配置
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# IP白名单（生产环境建议配置）
# IP_WHITELIST=your_admin_ip,your_office_ip

# ===========================================
# 监控配置
# ===========================================
# 健康检查配置
HEALTH_CHECK_INTERVAL=30000

# 性能监控
ENABLE_PERFORMANCE_MONITORING=true
PERFORMANCE_SAMPLE_RATE=0.1

# 错误监控（建议配置告警webhook）
ENABLE_ERROR_MONITORING=true
# ERROR_NOTIFICATION_WEBHOOK=https://your-alert-webhook.com/api

# ===========================================
# 业务配置
# ===========================================
# 佣金配置
COMMISSION_CALCULATION_ENABLED=true
COMMISSION_SETTLEMENT_DAY=1

# 通券配置
POINTS_TRANSFER_ENABLED=true
POINTS_MIN_TRANSFER_AMOUNT=1
POINTS_MAX_TRANSFER_AMOUNT=100000
POINTS_DAILY_TRANSFER_LIMIT=1000000

# 订单配置
ORDER_AUTO_CANCEL_MINUTES=30
ORDER_REFUND_DAYS=7

# 库存配置
INVENTORY_WARNING_THRESHOLD=10
INVENTORY_AUTO_REORDER_ENABLED=false

# ===========================================
# 生产环境专用配置
# ===========================================
# 关闭开发工具
ENABLE_CORS=true
ENABLE_SWAGGER=false
ENABLE_MOCK_DATA=false
ENABLE_DEBUG_LOGS=false

# 生产环境安全配置
PROD_ENABLE_HTTPS=true
PROD_ENABLE_COMPRESSION=true
PROD_ENABLE_CACHE=true
PROD_CACHE_TTL=3600

# 生产环境监控配置
PROD_ENABLE_METRICS=true
PROD_METRICS_PORT=9090

# ===========================================
# 本地开发时临时配置（仅在本地测试时使用）
# ===========================================
# 如果需要本地测试，可以临时启用以下配置：
# LOCAL_CORS_ORIGINS=http://localhost:3000,http://localhost:8080,http://localhost:5173,http://localhost:5174
# LOCAL_ENABLE_SWAGGER=true
# LOCAL_ENABLE_DEBUG_LOGS=true